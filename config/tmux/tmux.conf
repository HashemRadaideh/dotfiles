# `tmux` configuration file

# set vi motion key mode
setw -g mode-keys vi
set -g status-keys vi

# bind prefix to C-space
unbind-key C-b
set -g prefix C-space

# vi motion between panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Use Alt-hjkl keys to switch panes
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Use Alt-arrow keys to switch panes
# bind -n M-Left select-pane -L
# bind -n M-Right select-pane -R
# bind -n M-Up select-pane -U
# bind -n M-Down select-pane -D

# Shift arrow to switch windows
# bind -n S-Left previous-window
# bind -n S-Right next-window

bind F3 next-window
bind F4 previous-window

# Shift tab to switch windows
bind Tab next-window
bind S-Tab previous-window

# Shift tab to switch windows
bind -n M-Tab next-window
bind -n M-S-Tab previous-window

# Set easier window split keys
bind "\\" split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Set easier window split keys
bind -n M-v split-window -h
bind -n M-s split-window -v

# Reload config file
bind r source-file ~/.config/tmux/tmux.conf \; \
  display-message "Successfully reloaded configuration!"

# Enable mouse
set -g mouse on
set -g mouse on
bind -n WheelUpPane if-shell \
  -F -t = "#{mouse_any_flag}" \
  "send-keys -M" "if -Ft= '#{pane_in_mode}'\
  'send-keys -M' 'copy-mode -e; send-keys -M'"

# https://unix.stackexchange.com/questions/348771/why-do-vim-colors-look-different-inside-and-outside-of-tmux
set -ag terminal-overrides ",xterm-256color:RGB"
set  -g default-terminal "tmux-256color"
set -g default-shell "/bin/zsh"
set -g history-limit 20000
set -g buffer-limit 20
set -sg escape-time 0
set -g display-time 1500
set -g remain-on-exit off
set -g repeat-time 300
setw -g allow-rename on
setw -g automatic-rename on
setw -g aggressive-resize on
set -g set-titles on
set -g set-titles-string "#W"
set -g base-index 1
setw -g pane-base-index 1
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

# general status bar settings
set -g status on
set -g status-interval 1
set -g status-position top
set -g status-justify left

# onedark
black="#282c34"
red="#e06c75"
green="#98c379"
yellow="#e5c07b"
blue="#61afef"
magenta="#c678dd"
cyan="#56b6c2"
white="#abb2bf"
grey="#3e4452"

# tokyo night
# black="#24283b"
# red="#f7768e"
# orange="#ff9e64"
# yellow="#e0af68"
# green="#9ece6a"
# cyan="#7dcfff"
# blue="#7aa2f7"
# magenta="#bb9af7"
# white="#c0caf5"
# grey="#565f89"

# status line style
set -g status-style "fg=$white,bg=$black"

# command line style
set -g message-style "fg=$cyan,bg=$black"

set -g window-status-separator ""

set -g status-left-length 100
set -g status-right-length 100

#  modes
setw -g clock-mode-colour "#800080"
set -g mode-style "fg=$white,bg=$yellow"

# when window has monitoring notification
setw -g window-status-activity-style "fg=$yellow"

# status top
left_sep=""
right_sep=""
cell_sep_left=""
cell_sep_right=""

# status bottom
# left_sep=""
# right_sep=""
# cell_sep_left=""
# cell_sep_right=""

# Left widget of the status line
# set -g status-left "\
# #[fg=$blue,bg=$green]#(whoami)#[fg=$grey]@#[fg=$red]#H\
# #[fg=$grey] in #[fg=$yellow]#S #[fg=$grey]session\
# #[fg=$green,bg=$black]$left_sep"

set -g status-left "\
#[fg=$black,bg=$green] #S \
#[fg=$green,bg=$black]$left_sep"

# Center widget of the status line
set -g window-status-format "\
#[fg=$black,bg=$black]$left_sep\
#[fg=$white,bg=$black] #I $cell_sep_left #W \
#[fg=$black,bg=$black]$left_sep"
set -g window-status-current-format "\
#[fg=$black,bg=$grey]$left_sep\
#[fg=$cyan,bg=$grey] #I $cell_sep_left #W \
#[fg=$grey,bg=$black]$left_sep"

# ## Right widget of the status line
# set -g status-right "\
# #{prefix_highlight} | \
# #{?pane_at_top,top pane,bottom pane}\
# #[fg=$white,bg=$red]\
# #([ $(tmux show-option -qv key-table) = 'off' ] && echo 'OFF')#[default]\
# #[fg=$black,bg=$magenta]#{?window_zoomed_flag,[Z],}#[default] | \
# #{sysstat_cpu} | \
# #{sysstat_mem}#[default] | \
# #{battery_status_bg} #{battery_icon} #{battery_percentage} #{battery_remain} | \
# #{online_status} | \
# #[fg=$magenta]%h %d %H:%M#[default] |\
# #[fg=red,dim,bg=default]#(uptime | cut -f 4-5 -d ' ' | cut -f 1 -d ',') "

set -g status-right "\
#[fg=$grey,bg=$black]$right_sep\
#[fg=$white, bg=$grey] %H:%M %a, %d %h #[fg=$green,bg=$grey]$right_sep\
#[fg=$black,bg=$green,bold] #{battery_icon} #{battery_percentage} #[fg=$blue,bg=$green]$right_sep\
#[fg=$black,bg=$blue,bold]#{sysstat_cpu}#[fg=$red,bg=$blue]$right_sep\
#[fg=$black,bg=$red,bold]#{sysstat_mem}#[fg=$red,bg=$red]$right_sep\
#{prefix_highlight}"

# online and offline icon for tmux-online-status
set -g @online_icon "#[fg=$green]●#[default]"
set -g @offline_icon "#[fg=$red]●#[default]"

# Configure view templates for tmux-plugin-sysstat "MEM" and "CPU" widget
set -g @sysstat_cpu_view_tmpl " CPU:#[fg=#{cpu.color}]#{cpu.pused}#[default]"
set -g @sysstat_mem_view_tmpl "\
 MEM:#[fg=#{mem.color}]#{mem.pused}#[fg=$grey] $cell_sep_right \
#[fg=$grey]Used #[fg=#{mem.color}]#{mem.used}#[fg=$grey] of \
#[fg=#{mem.color}]#{mem.total}#[default]"

# Configure colors for tmux-plugin-sysstat "MEM" and "CPU" widget
set -g @sysstat_cpu_low "$green"
set -g @sysstat_cpu_medium "$yellow"
set -g @sysstat_cpu_stress "$red"

set -g @sysstat_mem_low "$green"
set -g @sysstat_mem_medium "$yellow"
set -g @sysstat_mem_stress "$red"

set -g @sysstat_swap_low "$green"
set -g @sysstat_swap_medium "$yellow"
set -g @sysstat_swap_stress "$red"

# Configure tmux-battery widget colors
set -g @batt_full_charge "#[fg=$green]"
set -g @batt_high_charge "#[fg=$green]"
set -g @batt_medium_charge "#[fg=$yellow]"
set -g @batt_low_charge "#[fg=$red]"

# Configure tmux-prefix-highlight colors
set -g @prefix_highlight_output_prefix "["
set -g @prefix_highlight_output_suffix "]"
set -g @prefix_highlight_fg "$black"
set -g @prefix_highlight_bg "$magenta"
set -g @prefix_highlight_show_copy_mode "on"
set -g @prefix_highlight_copy_mode_attr "fg=$black,bg=$magenta"

# update environment variables
set -g update-environment \
  "DISPLAY\
  SSH_ASKPASS\
  SSH_AUTH_SOCK\
  SSH_AGENT_PID\
  SSH_CONNECTION\
  SSH_TTY\
  WINDOWID\
  XAUTHORITY"

# ----------------------------------
# Plugin manager - tpm (tmux plugin manager)
# git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm
# ----------------------------------

# List of plugins
set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-continuum"
set -g @plugin "tmux-plugins/tmux-sessionist"
set -g @plugin "tmux-plugins/tmux-resurrect"
set -g @plugin "tmux-plugins/tmux-yank"
set -g @plugin "tmux-plugins/tmux-sensible"

set -g @plugin "tmux-plugins/tmux-battery"
set -g @plugin "tmux-plugins/tmux-prefix-highlight"
set -g @plugin "tmux-plugins/tmux-online-status"
set -g @plugin "tmux-plugins/tmux-sidebar"
set -g @plugin "tmux-plugins/tmux-copycat"
set -g @plugin "tmux-plugins/tmux-open"
set -g @plugin "samoshkin/tmux-plugin-sysstat"

# Plugin properties
set -g @sidebar-tree "t"
set -g @sidebar-tree-focus "T"
set -g @sidebar-tree-command "tree -C"

# tmux-resurrect settings.
set -g @resurrect-strategy-vim "session"

set -g @open-S "https://www.google.com/search?q="

# Initialize TMUX plugin manager
run "~/.config/tmux/plugins/tpm/tpm"
